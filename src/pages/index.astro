---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import FeaturedProjectCard from "../components/FeaturedProjectCard.astro";
import CTAButton from "../components/CTAButton.astro";
import { SITE_CONFIG } from "../utils/siteConfig";

const pageTitle = SITE_CONFIG.defaultTitle;
const pageDescription =
    "Hanif Carroll - Fractional CTO & Product Partner for bootstrapped founders. MVP development, prototype services, and technical leadership for nontechnical entrepreneurs. From stuck idea to working software.";

const featuredProjects = (await getCollection("projects"))
    .filter((project: CollectionEntry<"projects">) => project.data.isFeatured)
    .sort(
        (a: CollectionEntry<"projects">, b: CollectionEntry<"projects">) =>
            (a.data.order ?? 0) - (b.data.order ?? 0)
    );
---

<BaseLayout title={pageTitle} description={pageDescription}>
    <!-- Hero Section -->
    <section class="bg-white text-gray-800 min-h-[80vh] flex items-center">
        <div class="container w-full py-[60px] px-6 md:py-20 lg:py-[100px]">
            <div class="max-w-[800px] mx-auto text-center">
                <span
                    class="hero-tagline hero-animate text-[0.9rem] font-medium text-accent-600 uppercase tracking-[0.15em] mb-4 block"
                    data-delay="100">Build Fast · Grow Smart</span
                >
                <h1
                    class="hero-title hero-animate text-[3rem] font-light text-gray-900 m-0 mb-6 leading-[1.1] tracking-tight md:text-[3.5rem] md:mb-8 lg:text-[4rem]"
                    data-delay="200"
                >
                    From stuck idea to working software—without the stress
                </h1>
                <p
                    class="hero-description hero-animate text-lg font-light leading-relaxed text-gray-500 mb-10 max-w-[600px] mx-auto lg:text-[1.25rem]"
                    data-delay="300"
                >
                    I help bootstrapped nontechnical founders turn ambitious
                    ideas into software that users love. As your Fractional CTO
                    & Product Partner, I bridge the gap between vision and
                    execution.
                </p>
                <div
                    class="hero-actions hero-animate flex flex-col gap-4 items-center justify-center sm:flex-row sm:gap-5"
                    data-delay="400"
                >
                    <CTAButton
                        href="/contact?utm_source=hero#book"
                        text="Let's Talk"
                        size="medium"
                        external={false}
                        class="hero-button transform translate-y-0 hover:-translate-y-px transition-transform duration-200"
                    />
                    <CTAButton
                        href="/services"
                        text="View My Services"
                        size="medium"
                        variant="secondary"
                        class="hero-button transform translate-y-0 hover:-translate-y-px transition-transform duration-200"
                    />
                </div>
                <p
                    class="hero-credibility hero-animate text-sm text-gray-500 mt-8"
                    data-delay="500"
                >
                    Trusted by founders who've raised $0 and built products
                    users love anyway
                </p>
            </div>
        </div>
    </section>

    <!-- Services Preview Section -->
    <section class="bg-gray-50 text-gray-800 border-t border-gray-100">
        <div
            class="container max-w-container mx-auto py-20 px-6 md:py-[100px] lg:py-[120px]"
        >
            <div class="text-center mb-12">
                <h2
                    class="text-5xl font-light tracking-tight text-gray-900 leading-tight mb-4 md:text-[2.75rem]"
                >
                    How I Help Bootstrapped Founders Build
                </h2>
                <p
                    class="text-lg font-light leading-relaxed text-gray-500 max-w-2xl mx-auto"
                >
                    Two powerful ways to go from idea to revenue, designed for
                    founders who need momentum without burning cash
                </p>
            </div>
            <div class="grid gap-8 max-w-4xl mx-auto md:grid-cols-2">
                <!-- Build Fast -->
                <div
                    class="bg-white border border-gray-200 rounded-lg p-8 hover:shadow-lg transition-all duration-300"
                >
                    <div class="text-accent-600 mb-4">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="32"
                            height="32"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <path
                                d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"
                            ></path>
                            <path
                                d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"
                            ></path>
                            <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"
                            ></path>
                            <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"
                            ></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-medium text-gray-900 mb-2">
                        Build Fast
                    </h3>
                    <p class="text-sm text-gray-400 mb-3">5-7 weeks</p>
                    <p class="text-gray-600 mb-4">
                        Need a live demo or MVP to validate with users? Ship a
                        prototype in 7 days or full product in 4-6 weeks.
                    </p>
                    <ul class="text-sm text-gray-600 space-y-2 mb-6">
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            7-day Prototype Sprint
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            Live Product with Payments
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            Complete Handoff Kit
                        </li>
                    </ul>
                    <p class="text-sm font-medium text-accent-600">
                        Live & User-Ready or Money Back
                    </p>
                </div>

                <!-- Grow Smart -->
                <div
                    class="bg-white border border-gray-200 rounded-lg p-8 hover:shadow-lg transition-all duration-300"
                >
                    <div class="text-accent-600 mb-4">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="32"
                            height="32"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <line x1="12" x2="12" y1="20" y2="10"></line>
                            <line x1="18" x2="18" y1="20" y2="4"></line>
                            <line x1="6" x2="6" y1="20" y2="16"></line>
                        </svg>
                    </div>
                    <h3 class="text-xl font-medium text-gray-900 mb-2">
                        Grow Smart
                    </h3>
                    <p class="text-sm text-gray-400 mb-3">
                        1-3 days/week ongoing
                    </p>
                    <p class="text-gray-600 mb-4">
                        Got traction and need ongoing product & tech support?
                        Embed a Fractional CTO without the equity ask.
                    </p>
                    <ul class="text-sm text-gray-600 space-y-2 mb-6">
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            Product & UX Leadership
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            Technical Direction
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-accent-600 mt-1">•</span>
                            Process & Automation
                        </li>
                    </ul>
                    <p class="text-sm font-medium text-accent-600">
                        100% refund for first 3 clients (first 2 weeks)
                    </p>
                </div>
            </div>
            <div class="text-center mt-10">
                <CTAButton
                    href="/services"
                    text="View Full Service Details"
                    size="medium"
                />
            </div>
        </div>
    </section>

    <!-- About Preview Section -->
    <section class="bg-white text-gray-800">
        <div
            class="container max-w-container mx-auto py-20 px-6 md:py-[100px] lg:py-[120px]"
        >
            <div
                class="flex flex-col gap-10 items-center md:flex-row md:gap-[60px] md:items-start lg:gap-20"
            >
                <div class="max-w-[600px] order-2 md:order-1">
                    <h2
                        class="text-5xl font-light tracking-tight mb-8 text-gray-900 leading-tight md:text-[2.75rem]"
                    >
                        Why I Do This Work
                    </h2>
                    <div class="flex flex-col gap-6">
                        <p
                            class="text-lg font-light leading-relaxed text-gray-500 m-0"
                        >
                            Most ambitious founders hit the same wall: You know
                            exactly what users need, but turning that vision
                            into real, working software feels impossible.
                        </p>
                        <p
                            class="text-lg font-light leading-relaxed text-gray-500 m-0"
                        >
                            You've got the domain expertise. You understand the
                            problem better than any dev ever will. But
                            translating your vision into something users
                            actually love? That's where the real challenge
                            begins.
                        </p>
                        <p
                            class="text-lg font-light leading-relaxed text-gray-500 m-0"
                        >
                            I'm the technical partner who speaks founder, not
                            just code. I help bootstrapped nontechnical founders
                            bridge the gap between brilliant idea and shipped
                            product—without the equity ask or full-time salary.
                        </p>
                    </div>
                    <div class="mt-8">
                        <a
                            href="/about"
                            class="text-accent-600 font-medium hover:text-accent-700 transition-colors"
                        >
                            Read more about my approach →
                        </a>
                    </div>
                </div>
                <div class="flex-shrink-0 order-1 md:order-2">
                    <img
                        src="/img/portrait.webp"
                        alt="Hanif Carroll"
                        class="w-[280px] h-auto object-cover block rounded-sm md:w-[320px] lg:w-[360px]"
                        loading="lazy"
                    />
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Projects Section -->
    {
        featuredProjects.length > 0 && (
            <section id="featured-projects" class="bg-gray-50 text-gray-800">
                <div class="container max-w-container mx-auto py-20 px-6 md:py-[100px] lg:py-[120px]">
                    <h2 class="text-5xl font-light tracking-tight text-center mb-4 text-gray-900 leading-tight md:text-[2.75rem]">
                        Recent Projects
                    </h2>
                    <p class="text-lg font-light leading-relaxed text-gray-500 text-center max-w-2xl mx-auto mb-[60px] md:mb-20">
                        Personal projects where I apply the same user research,
                        strategic thinking, and rapid execution I bring to
                        client work
                    </p>

                    <div class="flex flex-col gap-[60px] md:gap-20 lg:gap-[100px]">
                        {featuredProjects.map((project: any) => {
                            return (
                                <FeaturedProjectCard
                                    title={project.data.title}
                                    description={project.data.description}
                                    tags={project.data.tags}
                                    image={project.data.image}
                                    imageAlt={
                                        project.data.imageAlt ??
                                        project.data.title
                                    }
                                    slug={project.slug}
                                    order={project.data.order}
                                />
                            );
                        })}
                    </div>
                    <div class="text-center mt-12">
                        <a
                            href="/projects"
                            class="text-accent-600 font-medium hover:text-accent-700 transition-colors"
                        >
                            View all projects →
                        </a>
                    </div>
                </div>
            </section>
        )
    }
</BaseLayout>

<script>
    // Wait for DOM to be ready
    document.addEventListener("DOMContentLoaded", () => {
        // Check if user prefers reduced motion
        const prefersReducedMotion = window.matchMedia(
            "(prefers-reduced-motion: reduce)"
        ).matches;

        if (prefersReducedMotion) {
            // If user prefers reduced motion, just show all elements
            document
                .querySelectorAll(".hero-animate, .hero-animate-scale")
                .forEach((el) => {
                    (el as HTMLElement).style.opacity = "1";
                    (el as HTMLElement).style.transform = "none";
                });
            return;
        }

        // Animate elements with staggered timing
        const animateElements = document.querySelectorAll(".hero-animate");
        const scaleElements = document.querySelectorAll(".hero-animate-scale");

        animateElements.forEach((el) => {
            const delay = parseInt(el.getAttribute("data-delay") || "0");
            setTimeout(() => {
                el.classList.add("animate-in");
            }, delay);
        });

        scaleElements.forEach((el) => {
            const delay = parseInt(el.getAttribute("data-delay") || "0");
            setTimeout(() => {
                el.classList.add("animate-scale-in");
            }, delay);
        });
    });
</script>

<style>
    /* Animation keyframes */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeInScale {
        from {
            opacity: 0;
            transform: scale(0.95) translateY(20px);
        }
        to {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    /* Initial states */
    .hero-animate {
        opacity: 0;
        transform: translateY(30px);
        transition: none;
    }

    .hero-animate-scale {
        opacity: 0;
        transform: scale(0.95) translateY(20px);
        transition: none;
    }

    /* Animated states */
    .hero-animate.animate-in {
        animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    .hero-animate-scale.animate-scale-in {
        animation: fadeInScale 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {
        .hero-animate,
        .hero-animate-scale {
            opacity: 1 !important;
            transform: none !important;
        }

        .hero-animate.animate-in,
        .hero-animate-scale.animate-scale-in {
            animation: none !important;
        }

        .hero-button:hover,
        .hero-image:hover {
            transform: none;
        }
    }
</style>
