---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import { createPageTitle } from "../../utils/siteConfig";
import CTAButton from "../../components/CTAButton.astro";

const pageTitle = createPageTitle("Projects");
const pageDescription = "Case studies and personal projects by Fractional CTO Hanif Carroll. See my approach to user research, strategic thinking, and rapid MVP development for founders.";

const projects = await getCollection("projects");
---

<BaseLayout title={pageTitle} description={pageDescription}>
    <!-- Hero Section -->
    <section class="bg-white text-gray-800">
        <div class="container max-w-4xl mx-auto py-20 px-6 md:py-[100px] lg:py-[120px]">
            <div class="text-center">
                <h1 class="text-5xl font-light tracking-tight leading-tight text-gray-900 mb-8 md:text-[2.75rem]">
                    Recent Projects & Case Studies
                </h1>
                <p class="text-xl font-light leading-relaxed text-gray-500 max-w-3xl mx-auto">
                    Personal projects where I apply the same user research, strategic thinking, and rapid execution I bring to client work.
                </p>
            </div>
        </div>
    </section>

    <!-- Projects Grid -->
    <section class="bg-gray-50 text-gray-800 border-t border-gray-100">
        <div class="container max-w-6xl mx-auto py-20 px-6 md:py-[100px] lg:py-[120px]">
            <div class="grid gap-12 md:grid-cols-2 lg:gap-16">
                {projects.map((project: CollectionEntry<"projects">) => (
                    <article class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group">
                        {project.data.image && (
                            <a href={`/projects/${project.slug}`} class="block overflow-hidden bg-gray-100">
                                <img 
                                    src={project.data.image.src} 
                                    alt={project.data.imageAlt || project.data.title}
                                    class="w-3/4 mx-auto h-auto object-contain group-hover:scale-105 transition-transform duration-300"
                                    loading="lazy"
                                />
                            </a>
                        )}
                        <div class="p-8">
                            <h2 class="text-2xl font-medium text-gray-900 mb-3 group-hover:text-accent-600 transition-colors">
                                <a href={`/projects/${project.slug}`} class="hover:text-accent-600">
                                    {project.data.title}
                                </a>
                            </h2>
                            <p class="text-lg text-gray-600 mb-4 line-clamp-2">
                                {project.data.description}
                            </p>
                            
                            {project.data.tags && project.data.tags.length > 0 && (
                                <div class="flex flex-wrap gap-2 mb-6">
                                    {project.data.tags.map((tag: string) => (
                                        <span class="text-sm px-3 py-1 bg-gray-100 text-gray-600 rounded-full">
                                            {tag}
                                        </span>
                                    ))}
                                </div>
                            )}
                            
                            <div class="flex items-center justify-between">
                                <a 
                                    href={`/projects/${project.slug}`} 
                                    class="inline-flex items-center text-accent-600 font-medium hover:text-accent-700 transition-colors group"
                                >
                                    View case study
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1 transition-transform group-hover:translate-x-1">
                                        <path d="M5 12h14"/>
                                        <path d="m12 5 7 7-7 7"/>
                                    </svg>
                                </a>
                                
                                <div class="flex gap-3">
                                    {project.data.siteLink && (
                                        <a 
                                            href={project.data.siteLink}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="text-gray-400 hover:text-gray-600 transition-colors"
                                            aria-label="View live site"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                                <polyline points="15 3 21 3 21 9"/>
                                                <line x1="10" x2="21" y1="14" y2="3"/>
                                            </svg>
                                        </a>
                                    )}
                                    {project.data.figmaLink && (
                                        <a 
                                            href={project.data.figmaLink}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="text-gray-400 hover:text-gray-600 transition-colors"
                                            aria-label="View in Figma"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M5 5.5A3.5 3.5 0 0 1 8.5 2H12v7H8.5A3.5 3.5 0 0 1 5 5.5z"/>
                                                <path d="M12 2h3.5a3.5 3.5 0 1 1 0 7H12V2z"/>
                                                <path d="M12 12.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 1 1-7 0z"/>
                                                <path d="M5 19.5A3.5 3.5 0 0 1 8.5 16H12v3.5a3.5 3.5 0 1 1-7 0z"/>
                                                <path d="M5 12.5A3.5 3.5 0 0 1 8.5 9H12v7H8.5A3.5 3.5 0 0 1 5 12.5z"/>
                                            </svg>
                                        </a>
                                    )}
                                </div>
                            </div>
                        </div>
                    </article>
                ))}
            </div>
        </div>
    </section>
</BaseLayout>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>